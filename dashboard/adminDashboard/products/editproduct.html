<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Edit Product</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="stylesheet" href="../sidebar/sidebar.css" />
  </head>
  <body class="bg-light">
    <!-- Sidebar -->
    <section id="sideBar">
      <div class="row"></div>
      <button class="sidebar-toggler">â˜°</button>
      <a href="../../../index.html" class="logo">
        <svg
          width="38"
          height="38"
          viewBox="0 0 38 38"
          class="livingo-icon"
          aria-hidden="true"
        >
          <ellipse cx="19" cy="13" rx="10" ry="7" fill="#cdbc92" />
          <rect x="17" y="13" width="4" height="13" rx="2" fill="#a0804d" />
          <ellipse cx="19" cy="31" rx="7" ry="3" fill="#59442a" />
          <ellipse
            class="lamp-glow"
            cx="19"
            cy="20"
            rx="12"
            ry="4"
            fill="#edd67d"
            opacity="0.14"
          />
        </svg>
        <span class="livingo-word">Living<span class="cushion-o">o</span></span>
      </a>
      <ul class="menu">
        <li>
          <a href="../index/admin.html" class="active">
            <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
              <path
                d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5z"
              />
            </svg>
            <p>Dashboard</p>
          </a>
        </li>
        <li>
          <a href="../products/products.html">
            <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
              <path
                d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
              />
            </svg>
            <p>Products</p>
          </a>
        </li>
        <li>
          <a href="../users/users.html">
            <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
              <path
                d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"
              />
            </svg>
            <p>Users</p>
          </a>
        </li>
        <li>
          <a href="../sellers/sellers.html">
            <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
              <path
                d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"
              />
              <path
                fill-rule="evenodd"
                d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"
              />
              <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z" />
            </svg>
            <p>Seller</p>
          </a>
        </li>
        <li>
          <a href="../orders/orders.html">
            <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
              <path
                d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"
              />
            </svg>
            <p>Orders</p>
          </a>
        </li>
        <li class="logout">
          <a id="logOut">
            <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
              <path
                fill-rule="evenodd"
                d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"
              />
              <path
                fill-rule="evenodd"
                d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"
              />
            </svg>
            <p>Logout</p>
          </a>
        </li>
      </ul>
    </section>
    <div class="container py-5">
      <h2 class="mb-4">Edit Product</h2>

      <div id="productFormContainer" class="card shadow-sm p-4">
        <div class="row">
          <div class="col-md-4 text-center">
            <img
              id="productImage"
              src=""
              alt="Product Image"
              class="img-fluid rounded mb-3"
              style="max-height: 250px; object-fit: cover"
            />
          </div>
          <div class="col-md-8">
            <form id="editProductForm">
              <div class="mb-3">
                <label class="form-label">Name</label>
                <input type="text" id="name" class="form-control" required />
              </div>
              <div class="mb-3">
                <label class="form-label">Price</label>
                <input type="number" id="price" class="form-control" required />
              </div>
              <div class="mb-3">
                <label class="form-label">Description</label>
                <textarea
                  id="description"
                  class="form-control"
                  rows="3"
                  required
                ></textarea>
              </div>
              <div class="mb-3">
                <label class="form-label">Stock</label>
                <input type="number" id="stock" class="form-control" required />
              </div>
              <button type="submit" class="btn btn-success">
                Save Changes
              </button>
              <a href="products.html" class="btn btn-secondary">Cancel</a>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Get product ID from URL
      const params = new URLSearchParams(window.location.search);
      const productId = params.get("id");

      let products = JSON.parse(localStorage.getItem("products")) || [];
      const product = products.find((p) => p.id === productId);

      if (product) {
        document.getElementById("name").value = product.name;
        document.getElementById("price").value = product.price;
        document.getElementById("description").value = product.description;
        document.getElementById("stock").value = product.stock;
        document.getElementById("productImage").src =
          "../../../assets/" + product.images[0];
      }

      document
        .getElementById("editProductForm")
        .addEventListener("submit", (e) => {
          e.preventDefault();
          const index = products.findIndex((p) => p.id === productId);

          if (index !== -1) {
            products[index].name = document.getElementById("name").value;
            products[index].price = parseFloat(
              document.getElementById("price").value
            );
            products[index].description =
              document.getElementById("description").value;
            products[index].stock = parseInt(
              document.getElementById("stock").value
            );
          }

          localStorage.setItem("products", JSON.stringify(products));
          window.location.href = "products.html";
        });
    </script>
  </body>
</html>
