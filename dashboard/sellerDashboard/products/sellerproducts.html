<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seller Dashboard - My Products</title>

  <!-- Bootstrap (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet" />

  <style>
    /* Global */
    html,
    body {
      background: #f6f2e7;
      font-family: "Inter", Arial, sans-serif;
      margin: 0;
      display: flex;
    }

    #edit {
      border-color: #ba6931 !important;
    }

    main {
      transition: all 0.3s ease;
    }

    .custom-table thead th {
      background: #000000;
      color: #f1e1b7;
      font-size: 1.08em;
      font-weight: 700;
      padding: 20px 15px;
      border: none;
      letter-spacing: 0.03em;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .header-section {
      padding: 0px 0px 0 25px;
    }

    .header-section h1 {
      color: #a0804d;
      font-weight: 700;
      letter-spacing: 0.04em;
      font-size: 2.4rem;
      margin-bottom: 20px;
      margin-top: 15px !important;
    }


    .table-responsive {
      margin: 0;
      background: transparent;
      border-radius: 19px;


    }


    .sidebar {
      width: 250px;
      background: #f0f0f0;
      color: black;
      height: 100vh;

      position: fixed;
      top: 0;
      left: 0;
      transition: transform 0.3s ease;
      z-index: 1000;

    }

    #sidebar .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 2rem;
      text-decoration: none;
      font-size: 2rem;
      font-weight: bold;
      color: #40372e;
      padding: 20px;
    }

    #sidebar .logo .cushion-o {
      color: #a0804d;
      font-size: 2.5rem;
      margin-left: 5px;
    }

    #sidebar a {
      gap: 12px;
      text-decoration: none;
      color: black;
      padding: 7px;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .sidebar p {
      margin-left: 35px;
    }

    header {
      margin-bottom: 20px;
    }

    .sidebar ul {
      list-style: none;
      padding: 0;
      margin-top: 15px;

    }

    .sidebar ul li {
      margin-left: 15px;
      margin-top: 30px;
      padding-top: 5px;
      padding-left: 10px;

    }

    .sidebar ul li:hover {
      border-style: none;
      border-radius: 10px;
      width: 200px;
      height: 40px;
      background-color: #A0804D;
    }

    .sidebar ul li.active {
      background-color: #A0804D;
      border-radius: 10px;
      width: 200px;
      height: 40px;
    }

    .sidebar ul li.active a {
      color: white;
      font-weight: bold;
    }

    .sidebar ul li a {
      color: rgb(0, 0, 0);
      text-decoration: none;
      margin-bottom: 20px;

    }

    .sidebar ul li a:hover {
      color: rgb(255, 255, 255);
    }

    .sidebar ul li.active a {
      color: white;
      font-weight: bold;
    }

    .sidebar img {
      width: 100px;
      border-radius: 50%;
      margin-left: 35px;
      margin-bottom: 10px;
    }

    i {
      margin-right: 20px;
    }

    .content {
      margin-left: 250px;
      padding: 20px;
      width: 82vw !important;
    }

    .orders-section {
      margin-top: 20px;
    }

    /* sidemenu Button  */
    .sidemenu {
      display: none;
      font-size: 20px;
      background: #333333;
      color: #ffffff;
      padding: 5px 10px;
      cursor: pointer;
      position: fixed;
      top: 5px;
      border-radius: 5px;
      margin-left: 10px;

      cursor: pointer;
    }

    .btn-close {
      display: none;
      position: absolute;
      top: 10px;
      right: 10px;
      border: none;

    }

    .addproduct {
      background-color: #af995d;
      border: none;
      transition: .2s;
    }

    .addproduct:hover {
      background-color: #d2b667;
      box-shadow: 2px 2px 2px black;
      scale: 1.02;
    }

    .edit {
      background-color: #af995d;
      border: none;
      color: black;
    }

    .edit:hover {
      background-color: #d2b667 !important;
      color: black;
      box-shadow: 2px 2px 2px gray !important;
      transform: scale(1.02);
    }

    .delete {
      background-color: black;
      border: none;
      color: #af995d;
      transition: all .09s;
    }

    .delete:hover {
      box-shadow: 2px 2px 2px gray;
      background-color: rgb(39, 38, 39);
      color: rgb(239, 213, 178);
      transform: scale(1.02);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .sidemenu {
        display: block;
      }

      .btn-close {
        display: block;
      }

      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.active {
        transform: translateX(0);
      }

      .content {
        margin-left: 0;
        padding-top: 60px;
        width: 100vw !important;
      }
    }


    @media (min-width: 769px) and (max-width:1300px) {
      .content {
        margin-left: 110px;
        padding-top: 60px;
        width: 85% !important;
      }

      .livingo-icon {
        width: 100px !important;
        margin-right: .2rem;
      }

      .sidebar {
        width: 100px;
        background: #f0f0f0;
        color: black;
        height: 100vh;

        position: fixed;
        top: 0;
        left: 0;
        transition: transform 0.3s ease;
        z-index: 1000;

      }

      span {
        display: none;
      }

      .sidebar ul li:hover {
        border-style: none;
        border-radius: 10px;
        width: 70px;
        height: 40px;
        background-color: #A0804D;
      }

      .sidebar ul li.active {
        width: 70%;
      }

    }

    .table img {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border-radius: 4px;
    }
  </style>
</head>

<body>
  <!-- Sidebar -->
  <div class="sidemenu" onclick="toggleSidebar()">&#9776;</div>

  <aside class="sidebar" id="sidebar">
    <button class="btn-close btn-close-black" aria-label="Close" onclick="toggleSidebar()"></button>
    <a href="../../../index.html" class="logo">
      <svg width="38" height="38" viewBox="0 0 38 38" class="livingo-icon" aria-hidden="true">
        <!-- Lamp shade -->
        <ellipse cx="19" cy="13" rx="10" ry="7" fill="#cdbc92" />
        <!-- Stand -->
        <rect x="17" y="13" width="4" height="13" rx="2" fill="#a0804d" />
        <!-- Base -->
        <ellipse cx="19" cy="31" rx="7" ry="3" fill="#59442a" />
        <!-- Light glow, animated in -->
        <ellipse class="lamp-glow" cx="19" cy="20" rx="12" ry="4" fill="#edd67d" opacity="0.14" />
      </svg>
      <span class="livingo-word">Living<span class="cushion-o">o</span></span>
    </a>
    <ul>
      <li>
        <a href="../index/index.html">
          <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
            <path
              d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5z" />
          </svg>
          <span style="margin-left: 10px;">Dashboard</span>
        </a>
      </li>
      <li class="active">
        <a href="#">

          <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24">
            <path fill="#000"
              d="M5 21q-.425 0-.712-.288T4 20v-1q-1.25 0-2.125-.875T1 16v-5q0-.825.588-1.412T3 9t1.413.588T5 11v4h14v-4q0-.825.588-1.412T21 9t1.413.588T23 11v5q0 1.25-.875 2.125T20 19v1q0 .425-.288.713T19 21t-.712-.288T18 20v-1H6v1q0 .425-.288.713T5 21m2-8v-2q0-1.375-.837-2.463T4 7V6q0-1.25.875-2.125T7 3h10q1.25 0 2.125.875T20 6v1q-1.35.35-2.175 1.463T17 11v2z" />
          </svg>
          <span style="margin-left: 10px;">Products</span>
        </a>
      </li>
      <li>
        <a href="../orders/orders.html">
          <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
            <path
              d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
          </svg>
          <span style="margin-left: 10px;">Orders</span>
        </a>
      </li>
      <li>
        <a id="logOut">
          <svg width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
            <path fill-rule="evenodd"
              d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z" />
            <path fill-rule="evenodd"
              d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z" />
          </svg>
          <span style="margin-left: 10px;">Logout</sp>
        </a>
      </li>
    </ul>
  </aside>
  <!-- Main Content -->
  <main class="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 style="color: #a0804d ;"> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24">
          <path fill="#b69d6f"
            d="M5 21q-.425 0-.712-.288T4 20v-1q-1.25 0-2.125-.875T1 16v-5q0-.825.588-1.412T3 9t1.413.588T5 11v4h14v-4q0-.825.588-1.412T21 9t1.413.588T23 11v5q0 1.25-.875 2.125T20 19v1q0 .425-.288.713T19 21t-.712-.288T18 20v-1H6v1q0 .425-.288.713T5 21m2-8v-2q0-1.375-.837-2.463T4 7V6q0-1.25.875-2.125T7 3h10q1.25 0 2.125.875T20 6v1q-1.35.35-2.175 1.463T17 11v2z" />
        </svg> My Products</h2>
      <a href="selleraddproduct.html" class="btn btn-primary addproduct">
        <i class="fas fa-plus"></i> Add Product
      </a>
    </div>

    <!-- Products Table -->
    <div class="table-responsive">
      <table class="table table-hover align-middle custom-table">
        <thead class="table-light">
          <tr>
            <th>Image</th>
            <th>Product</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="sellerProductsTableBody"></tbody>
      </table>
    </div>
  </main>

  <!-- Bootstrap Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function renderSellerProducts() {
      const currentUser = JSON.parse(localStorage.getItem("currentUser"));
      const users = JSON.parse(localStorage.getItem("users")) || [];
      const products = JSON.parse(localStorage.getItem("products")) || [];

      if (!currentUser) {
        alert("No seller logged in!");
        return;
      }

      // Find the seller user
      const seller = users.find(
        (u) => u.id === currentUser.id && u.role === "seller"
      );
      if (!seller) {
        alert("Seller not found!");
        return;
      }

      // document.getElementById("storeName").textContent = seller.storeName;

      // Filter products belonging to seller
      const sellerProducts = products.filter((p) =>
        seller.products.includes(p.id)
      );

      const tableBody = document.getElementById("sellerProductsTableBody");
      tableBody.innerHTML = "";

      sellerProducts.forEach((p) => {
        tableBody.innerHTML += `
          <tr>
            <td><img src="../../../assets/${p.images[0]}" alt="${p.name}"></td>
            <td>${p.name} <br><small>#${p.id}</small></td>
            <td>${p.price} ${p.currency || "EGP"}</td>
            <td>${p.stock}</td>
            
            <td>
              <button class="btn btn-sm btn-primary edit" onclick="editSellerProduct('${p.id
          }')">
                <i class="fas fa-edit m-1 "></i>
              </button>
              <button class="btn btn-sm btn-danger delete" onclick="deleteSellerProduct('${p.id
          }')">
                <i class="fas fa-trash m-1 "></i>
              </button>
            </td>
          </tr>
        `;
      });
    }

    function deleteSellerProduct(productId) {
    if (confirm("Are you sure you want to delete this product?")) {
    let products = JSON.parse(localStorage.getItem("products")) || [];
    products = products.filter((p) => p.id !== productId);
    localStorage.setItem("products", JSON.stringify(products));
    renderSellerProducts(); // refresh seller's product list
  }
}


    function editSellerProduct(productId) {
      window.location.href = `selleredit.html?id=${productId}`;
    }

    document.addEventListener("DOMContentLoaded", renderSellerProducts);

    function setActiveMenuItem(clickedElement) {
      document.querySelectorAll('.sidebar ul li').forEach(li => {
        li.classList.remove('active');
      });
      clickedElement.parentElement.classList.add('active');
    }

    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("active");
    }


    const logout = document.getElementById("logOut")
    logout.addEventListener("click", function () {
      const confirmLogout = confirm("Are you sure you want to log out?");
   
      if (confirmLogout) {
       localStorage.removeItem("currentUser");
       alert("You have been logged out successfully.");
       window.location.href = "../../../sign/login/login.html";
     }
    });
  </script>
</body>

</html>
